name: Java Setup on macOS (Intel & Apple Silicon)
on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main
  workflow_dispatch: # Allows manual trigger
jobs:
  setup-mac:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        include:
          - os: macos-12 # macOS Intel (x86_64)
            script: JavaSetup_Mac_Intel.sh
          - os: macos-14 # macOS Apple Silicon (ARM64)
            script: JavaSetup_Mac_Silicon.sh
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
      - name: Create Target Directory & Change Into It
        run: |
          mkdir -p "$HOME/.local/java"
          cd "$HOME/.local/java"
          echo "Working directory is now: $(pwd)"
          echo "HOME_LOCAL_JAVA=$HOME/.local/java" >> $GITHUB_ENV
      - name: Debug System Information
        run: |
          echo "🏗️ Running on: $(uname -s)"
          echo "🖥️ Architecture: $(uname -m)"
          echo "🍏 macOS Version: $(sw_vers -productVersion)"
          echo "🔍 Default Shell: $SHELL"
          echo "🐚 Default Bash Version:"
          /bin/bash --version
      - name: Run Java Setup Script with Default Bash
        run: |
          cd "$HOME/.local/java"
          /bin/bash ${{ matrix.script }}
